/*! Vimg | v0.1.0 | Author: David McKeown | https://github.com/ScottishDave/Vimg | MIT license */ 
(function(a,b){"use strict";var c;c=function(){function a(a){c=this,this.options=a||{},this.options.selector=this.options.selector||".vimg",this.options.interval=parseInt(this.options.interval)||1e3,this.options.offset=parseInt(this.options.offset)||300,d.nodes=f.querySelectorAll(this.options.selector),this.nodes=[];for(var b=0;b<d.nodes.length;b++)this.nodes.push(d.nodes[b]);return this.listen(),d._shouldPoll=!0,this.pollNodes(),{poll:this.pollNodes,images:this.nodes}}var c={},d={},e=window,f=b;return a.prototype.listen=function(){return this.subscribeEvent(e,"scroll",this.shouldPoll),this.subscribeEvent(e,"resize",this.shouldPoll),this.subscribeEvent(e,"load",this.shouldPoll),this.throttled=setInterval(this.pollNodes,this.options.interval),this.throttled},a.prototype.subscribeEvent=function(a,b){return f.addEventListener?a.addEventListener(b,this.shouldPoll,!1):a.attachEvent("on"+b,this.shouldPoll)},a.prototype.unsubscribeEvent=function(a,b){return f.removeEventListener?a.removeEventListener(b,this.shouldPoll,!1):a.detachEvent("on"+b,this.shouldPoll)},a.prototype.emitEvent=function(a,b){var c=new Event(b);return a.dispatchEvent(c)},a.prototype.shouldPoll=function(){return d._shouldPoll=!0,d._shouldPoll},a.prototype.pollNodes=function(){var a;if(d._shouldPoll&&c.nodes.length>0){for(var b=0;b<c.nodes.length;b++)a=c.nodes[b],a&&c.withinView(a)&&(a.src=a.getAttribute("data-src"),c.emitEvent(a,"vimg-loaded"),delete c.nodes[b]);d._shouldPoll=!1}else 0===c.nodes.length&&(this.unsubscribeEvent(e,"scroll",this.shouldPoll),this.unsubscribeEvent(e,"resize",this.shouldPoll),this.unsubscribeEvent(e,"load",this.shouldPoll),clearInterval(this.throttled));return c.nodes},a.prototype.withinView=function(a){var c=a.getBoundingClientRect();return(c.top>=0&&c.left>=0&&c.top)<=(window.innerHeight||b.documentElement.clientHeight)+this.options.offset},a}(),"object"==typeof module&&"object"==typeof module.exports?module.exports=c:"function"==typeof define&&define.amd?define(function(){return c}):"object"==typeof window&&(window.Vimg=c)}).call(this,window,document);